#Data
products <- c(18898,16702.5,13492.7,13947.7,12280,12995.4,12160,11200,11845,11254,10031.1,9786.7,8872.4,7333.3,7061.7,6518.5,6880.6,7695.5,8691.3,7514.4,7423.9,8510.3,6699.6,7333.3,9046,6756.6,7773.3,7037.9,6569.4,5516.6,5801.4,4836.4,4765.9,4685,4549.6,4593,4144,4506.4,5241.9,5320.5,5879.6,6683.7,7356.5,6328.1,6681.4,6127.3,5905.6,6106.1,4999.7,5499.2,5437.5,5450.7,5733.3,5444.3,6084.1,6078.8,6125.8,6147.9,6743.4,6284.5,5966.2,5727.5,4127.4,5231.8,4144.4,3140.3,3720.6,4784.1,7382,30825,8128.9,7504.4,6421.5,6348.3,7222.3,6869,6165,7169.1,7136.7,7290.3,7552.5,7433.8,7646.9,8414,7141.1,6822.4,7525,7258.4,7214.1,7261.8,7541.6,7473.2,7602.2,7579,7204.6,7642.5,7050.4,6851.7,7431.7,7019.8,7152,6858.3,7724.2,7459.9,7872.5,7871.4,7786.6,8124.9,3124.6,2823.6,3002.5,3092.1,3192.2,3589.6,3427,3592.9,3664.6,3749.3,4097.7,4164.1,13,13.8,11.2,21.8,11,2.8,0,0,10.1,7.4,13.8,11.9,10068.8,10045.5,10289.2,10255.1,10192.9,10478.8,10604.8,10544.5,10637.1,10642,10691,10876.5,8247.1,8420,9072.3,8991.3,8983.3,9206.4,9265.7,9412.1,9423.8,9437.9,9588.7,9749.6,9058.9,9016.8,9259.4,9695.3,9738.9,9906.7,10047.1,10204,9865,10019.6,10043.7,9966.4,8391.8,8426.6,8619.1,8338.1,8287.1,8119.7,8275.7,8825.2,9043.4,10190.3,10292.2,9514.6,7027,7170.2,8540.1,8361.4,8367.4,8567.5,8784.3,9495.9,9537.7,11034.6,11086.4,11183.2,9494.7,9464.4,9685.8,9755.2,9418,8683.1,9117.5,12633.3,8333,8352.9,8494.8,8239.9,8551.5,8577.8,8845.6,8830,8729.4,8782.2,9013.4,8990.5,9475,9336.8,9815.1,9568.1,8622.8,8811,8851.2,8860.4,8929.7,8938.8,9123.5,9131.8,9544.4,9482.8,9521.3,9407,7385.3,7429.4,7622.7,7609.4,7584.3,7651.5,7815.5,7875.4,8106.4,8320.7,8333.6,9193.1,7463.8,7728.1,7644.4,8299.5,8243.3,8303.8,9684.2,9468.7,10033.6,10031.8,9388.1,10361.1,4564.1,4777.1,5021.3,5016.9,4803.3,5022.6,5239.3,5502.4,5669.2,5683,5853.3,6041.9)
p<- c(8391.8,8426.6,8619.1,8338.1,8287.1,8119.7,8275.7,8825.2,9043.4,10190.3,10292.2,9514.6,7027,7170.2,8540.1,8361.4,8367.4,8567.5,8784.3,9495.9,9537.7,11034.6,11086.4,11183.2,9494.7,9464.4,9685.8,9755.2,9418,8683.1,9117.5,12633.3,8333,8352.9,8494.8,8239.9,8551.5,8577.8,8845.6,8830,8729.4,8782.2,9013.4,8990.5,9475,9336.8,9815.1,9568.1,12902.6,13346.5,14417,15029.5,8622.8,8811,8851.2,8860.4,8929.7,8938.8,9123.5,9131.8,9544.4,9482.8,9521.3,9407,7385.3,7429.4,7622.7,7609.4,7584.3,7651.5,7815.5,7875.4,8106.4,8320.7,8333.6,9193.1,7463.8,7728.1,7644.4,8299.5,8243.3,8303.8,9684.2,9468.7,10033.6,10031.8,9388.1,10361.1,4564.1,4777.1,5021.3,5016.9,4803.3,5022.6,5239.3,5502.4,5669.2,5683,5853.3,6041.9)
length(products)
length(p)
months<-1:length(products)


#Decomposition 

products_ts<-ts(products, start=1994, frequency=12)
decomposition<-stl(products_ts, s.window = "periodic")
decomposition
#graph the decomposition
plot(decomposition)

#Least squares line
least_sq_line<-lm(products~months)
least_sq_line

#Cyclical components

predicted_products<-coefficients(least_sq_line)[1]+coefficients(least_sq_line)[2]*year
predicted_products

cyclic<-products/predicted_products
cyclic

#prediction of the first three months of the 2016
m <- length(months)
quarter_2016 <- c(m+1,m+2,m+3)
res_predicted <- (coefficients(least_sq_line)[1]+coefficients(least_sq_line)[2]*quarter_2016[1])*decomposition$time.series[1]+
  (coefficients(least_sq_line)[1]+coefficients(least_sq_line)[2]*quarter_2016[2])*decomposition$time.series[2]+
  (coefficients(least_sq_line)[1]+coefficients(least_sq_line)[2]*quarter_2016[3])*decomposition$time.series[3]
res_predicted